var sbplus=function(){function t(){$.fn.haveCoreFeatures()?$.get("assets/sbplus.xml",function(t){c.data=$(t),e()}).fail(function(){sbplusError.show("Table of Contents XML file (sbplus.xml) is not found!","Please make sure the XML file exists in the assets directory and compatible with Storybook Plus version 3.")}):$.get(r.sbplus_root_directory+"scripts/templates/nosupport.tpl",function(t){i(t)}).fail(function(){sbplusError.show("Unsupported web browser!","Your web browser does not support current version of Storybook Plus. In addition, nosupport.tpl file is not found. nosuppory.tpl file contains information to display in regard to unsupported web browsers.")})}function e(){var t=c.data.find("storybook"),e=c.data.find("setup");c.title=e.find("title").text(),c.subtitle=e.find("subtitle").text(),c.author=e.find("author").attr("name"),c.authorBio=e.find("author").text(),c.length=e.find("length").text(),c.generalInfo=e.find("generalInfo").text(),c.postfix=e.attr("postfix"),c.section=c.data.find("section"),l.accent=$.fn.isEmpty(t.attr("accent"))?l.accent:t.attr("accent"),l.slideFormat=$.fn.isEmpty(t.attr("slideFormat"))?l.slideFormat:t.attr("slideFormat"),l.analytics=$.fn.isEmpty(t.attr("analytics"))?l.analytics:t.attr("analytics"),$.get(r.sbplus_root_directory+"scripts/templates/sbplus.tpl",function(t){s(t)}).fail(function(){sbplusError.show("Template file not found!","sbplus.tpl file not found in the templates directory.")})}function n(){$(".splashscreen").fadeOut("fast",function(){$(".main_content_wrapper").css("display","flex").fadeIn(500,function(){$(this).removeClass("hide"),$(".title_bar .title").html(c.title),$(".author").html(c.author),a(),$(window).resize(function(){a()}),sbplusSlide.get(c.section,l),sbplusTableOfContents.get(c,l),sbplusMenu.get(c)}),$(this).remove(),sbplusSplashScreen.unbindStartPresentationBtn()})}function s(t){$(document).attr("title",c.title),u.html(t),sbplusSplashScreen.get(r,c,l),o()}function i(t){u.html(t)}function o(){var t=document.createElement("script");t.type="text/javascript",t.src=r.sbplus_root_directory+"scripts/libs/videojs/video.min.js",document.getElementsByTagName("head")[0].appendChild(t);var e=document.createElement("link");e.rel="stylesheet",e.href=r.sbplus_root_directory+"scripts/libs/videojs/video-js.min.css",document.getElementsByTagName("head")[0].appendChild(e),$.fn.setCookie("sbplus-vjs-autoplay",1),$.fn.setCookie("sbplus-vjs-volume",.8),$.fn.setCookie("sbplus-vjs-playbackrate","1.5")}function a(){var t=$(window).outerHeight()-($(".main_content_wrapper .title_bar").outerHeight()+$(".main_content .control_bar_wrapper").outerHeight()+$(".main_content .container .content").outerHeight()),e=100*(1-$(".main_content_wrapper .title_bar").outerHeight()/$(window).outerHeight());$(".main_content, .side_panel").css("height",e+"%"),$(".main_content .notes").css("height",t)}var r,l={accent:"#535cab",slideFormat:"jpg",analytics:"off",xmlVersion:"3",trackCount:0},c={data:"",trackCount:0},u;return $(document).ready(function(){u=$(".sbplus_wrapper"),$.getJSON($.fn.getConfigFileUrl(),function(e){r=e,t()}).fail(function(){sbplusError.show("Configuration file (manifest.json) is not found!","Please make sure the index.html file is compatible with Storybook Plus version 3.")})}),{render:n}}(),sbplusDownloadable=function(){function t(){var t=$.fn.getProgramDirectory();$.get(t+".mp4",function(){s=this.url}).always(function(){$.get(t+".mp3",function(){i=this.url}).always(function(){$.get(t+".pdf",function(){o=this.url}).always(function(){$.get(t+".zip",function(){a=this.url}).always(function(){n()})})})})}function e(t,e){return'<a class="dl_item '+t+'" href="'+e+'" role="button" tabindex="1" aria-label="Download '+t+' file" download><span class="icon-download"></span> '+t.capitalize()+"</a> "}function n(){var t="";"undefined"!=typeof s&&(t+=e("video",s)),"undefined"!=typeof i&&(t+=e("audio",i)),"undefined"!=typeof o&&(t+=e("transcript",o)),"undefined"!=typeof a&&(t+=e("supplement",a)),$(".download_files").hide().html(t).fadeIn(500)}var s,i,o,a;return{get:t}}(),sbplusError=function(){function t(t,i){n=t,s=i,e()}function e(){$(".sbplus_wrapper").html('<div class="error"><h1>'+n+"</h1><p>"+s+"</p></div>")}var n,s;return{show:t}}(),sbplusSplashScreen=function(){function t(t,e,n){i=t,o=e,a=n,$.get(t.sbplus_root_directory+"scripts/templates/splashscreen.tpl",function(t){$.get("assets/splash.jpg",function(){r="assets/splash.jpg"}).fail(function(){$.get(i.sbplus_splash_directory+$.fn.getProgramDirectory()+o.postfix+".jpg",function(){r=this.url}).fail(function(){$.get(i.sbplus_splash_directory+$.fn.getProgramDirectory()+".jpg",function(){r=this.url})})}),s(t)}).fail(function(){sbplusError.show("Template file not found!","splashscreen.tpl file not found in the templates directory.")})}function e(){l.on("click",function(){sbplus.render()})}function n(){l.off("click")}function s(t){$(".splashscreen").html(t),""!==r&&$(".splashscreen").css("background-image","url("+r+")"),$(".splashinfo .title").html(o.title),$(".splashinfo .subtitle").html(o.subtitle),$(".splashinfo .author").html(o.author),$(".splashinfo .length").html(o.length),$(".splashinfo .startBtn").css("background-color",a.accent),navigator.cookieEnabled&&$.fn.checkValueInCookie("sbplus-"+$.fn.getRootDirectory())&&$(".splashinfo .resumeBtn").css("background-color",a.accent).removeClass("hide"),l=$(".splashinfo .startBtn"),e(),sbplusDownloadable.get()}var i,o,a,r="",l;return{get:t,unbindStartPresentationBtn:n}}(),sbplusTableOfContents=function(){function t(t,n){i=n,s=t,e()}function e(){var t=$(".tableOfContents");$.each(s.section,function(e){var n=$(this).find("page"),i=$.fn.isEmpty($(this).attr("title"))?"Section "+(e+1):$(this).attr("title");t.append('<div class="section"><div class="header"><div class="title">'+i+'</div><div class="expandCollapseIcon"><span class="icon-collapse"></span></div></div><div class="content"><ul class="selectable">'),$.each(n,function(t){$(".selectable:eq("+e+")").append('<li class="selectee" data-section="'+e+'" data-page="'+t+'">'+("quiz"!==$(this).attr("type")?'<span class="num">'+(s.trackCount+1)+".</span> ":'<span class="icon-assessment"></span> ')+$(this).attr("title")+"</li>"),s.trackCount++}),t.append("</ul></div></div>")}),n()}function n(){var t=$(".tableOfContents .section .header"),e=$(".selectable .selectee");s.section.length>=2?t.on("click",function(){var t=$(this).parent().find(".content"),e=$(this).parent().find(".expandCollapseIcon").find("span");$(t).is(":visible")?t.slideUp(250,function(){$(e).removeClass("icon-collapse").addClass("icon-open")}):t.slideDown(250,function(){$(e).removeClass("icon-open").addClass("icon-collapse")})}):t.remove(),e.on("click",function(){if(s.section.length>=2){var t=$(this).parent().parent().prev();$(".header").removeClass("current"),$(t).addClass("current")}$(this).hasClass("selected")||sbplusSlide.get(s.section,i,$(this).data("section"),$(this).data("page")),e.removeClass("selected"),$(this).addClass("selected")})}var s,i;return{get:t}}(),sbplusSlide=function(){function t(t,n,s,a){s="undefined"!=typeof s?Number(s):0,a="undefined"!=typeof a?Number(a):0,o=n,i=t,r=o.slideFormat,e(s,a)}function e(t,e){var s=$(i[t]).find("page")[e],o=$(s).attr("type");switch(a="quiz"!==o?$(s).attr("src"):"",null!==l&&(l.dispose(),l=null,$("#ap").remove()),o){case"audio":n("audio")}}function n(t){var e=$(".main_content .container .content"),n="",i="";switch(t){case"audio":$.get("assets/slide/"+a+"."+r,function(){i=this.url,$.get("assets/audio/"+a+".vtt",function(){n='<track kind="subtitles" src="assets/audio/'+a+'.vtt" srclang="en" label="English">'}).always(function(){var t='<source src="assets/audio/'+a+'.mp3" type="audio/mp3">';e.html('<video id="ap" class="video-js vjs-default-skin" poster="'+i+'">'+t+n+"</video>").promise().done(function(){s("ap")})})}).fail(function(){e.html("Image not found!","Expected image: assets/slide/"+a+"."+r)})}}function s(t){var e={techOrder:["html5"],width:640,height:360,controls:!0,autoplay:"1"===$.fn.getCookie("sbplus-vjs-autoplay"),preload:"auto",playbackRates:[.5,1,1.5,2],plugins:{}};switch(t){case"ap":e.plugins=null}l=videojs(t,e,function(){this.removeChild("vjs-fullscreen-control"),this.volume(Number($.fn.getCookie("sbplus-vjs-volume"))),this.rate(1.5)})}var i,o,a,r,l=null;return{get:t}}(),sbplusNotes=function(){function t(t){n=t,e()}function e(){}var n;return{get:t}}(),sbplusMenu=function(){function t(t){o=t,e()}function e(){n()}function n(){$(".menuBtn").on("click",function(){return $(this).attr("aria-expanded","true"),$("#menu_panel").removeClass("hide").attr("aria-expanded","true"),!1}),$(".backBtn").on("click",function(){return i(),!1}),$(".closeBtn").on("click",function(){return $(".menuBtn").attr("aria-expanded","false"),$("#menu_panel").addClass("hide").attr("aria-expanded","false"),i(),!1}),$("#showProfile").on("click",s),$("#showGeneralInfo").on("click",s),$("#showHelp").on("click",s),$("#showSettings").on("click",s)}function s(){var t,e,n="#"+this.id;switch(n){case"#showProfile":t="Author Profile",e=o.authorBio;break;case"#showGeneralInfo":t="General Information",e=o.generalInfo;break;case"#showHelp":t="Help",e="<p>Help information go here...</p>";break;case"#showSettings":t="Settings",e="<p>Settings go here...</p>";break;default:t="",e=""}return""!==t&&""!==e&&i(this,t,e),!1}function i(t,e,n){return"undefined"==typeof t?($(".menu_item a").attr("aria-expanded","false"),void $(".menu_item_details").attr("aria-expanded","false").animate({right:"-100%"},250,function(){$(this).addClass("hide")})):($(t).attr("aria-expanded","true"),$(".menu_item_details").attr("aria-expanded","true"),$(".menu_item_details .navbar .title").html(e),$(".menu_item_details .menu_item_content").html(n),void $(".menu_item_details").removeClass("hide").animate({right:"0px"},250))}var o;return{get:t}}();$.fn.getProgramDirectory=function(){var t=window.location.href.split("/");return($.fn.isEmpty(t[t.length-1])||new RegExp("[?]").test(t[t.length-1]))&&t.splice(t.length-1,1),void 0===t[4]?t[3]:t[4]},$.fn.getRootDirectory=function(){var t=window.location.href.split("/");return($.fn.isEmpty(t[t.length-1])||new RegExp("[?]").test(t[t.length-1])||"index.html"===t[t.length-1])&&t.splice(t.length-1,1),t[t.length-1]},$.fn.getConfigFileUrl=function(){var t=document.getElementById("sbplus_configs");return null===t?!1:t.href},$.fn.isEmpty=function(t){return!t.trim()||0===t.trim().length},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$.fn.haveCoreFeatures=function(){return!!(Modernizr.audio&&Modernizr.video&&Modernizr.json&&Modernizr.flexbox)},$.fn.setCookie=function(t,e,n){var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3);var i="expires="+s.toUTCString();document.cookie=t+"="+e+"; "+i},$.fn.getCookie=function(t){for(var e=t+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var i=n[s];" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(e))return i.substring(e.length,i.length)}return""},$.fn.deleteCookie=function(t){document.cookie=t+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"},$.fn.checkValueInCookie=function(t){var e=$.fn.getCookie(t);return""!==e};
//# sourceMappingURL=./sbplus.js.map