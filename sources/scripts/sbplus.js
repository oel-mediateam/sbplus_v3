var sbplus=function(){function e(){$.fn.haveCoreFeatures()?$.get("assets/sbplus.xml",function(e){c.data=$(e),t()}).fail(function(){sbplusError.show("Table of Contents XML file (sbplus.xml) is not found!","Please make sure the XML file exists in the assets directory and compatible with Storybook Plus version 3.")}):$.get(r.sbplus_root_directory+"scripts/templates/nosupport.tpl",function(e){o(e)}).fail(function(){sbplusError.show("Unsupported web browser!","Your web browser does not support current version of Storybook Plus. In addition, nosupport.tpl file is not found. nosuppory.tpl file contains information to display in regard to unsupported web browsers.")})}function t(){var e=c.data.find("storybook"),t=c.data.find("setup");c.title=t.find("title").text(),c.subtitle=t.find("subtitle").text(),c.author=t.find("author").attr("name"),c.authorBio=t.find("author").text(),c.length=t.find("length").text(),c.generalInfo=t.find("generalInfo").text(),c.postfix=t.attr("postfix"),c.section=c.data.find("section"),u.accent=$.fn.isEmpty(e.attr("accent"))?u.accent:e.attr("accent"),u.slideFormat=$.fn.isEmpty(e.attr("slideFormat"))?u.slideFormat:e.attr("slideFormat"),u.analytics=$.fn.isEmpty(e.attr("analytics"))?u.analytics:e.attr("analytics"),$.get(r.sbplus_root_directory+"scripts/templates/sbplus.tpl",function(e){s(e)}).fail(function(){sbplusError.show("Template file not found!","sbplus.tpl file not found in the templates directory.")})}function n(){$(".splashscreen").fadeOut("fast",function(){$(".main_content_wrapper").css("display","flex").fadeIn(500,function(){$(this).removeClass("hide"),$(".title_bar .title").html(c.title),$(".author").html(c.author),l(),$(window).resize(function(){l()}),sbplusTableOfContents.get(c,u),sbplusSlide.get(c.section,u),sbplusMenu.get(c)}),$(this).remove(),sbplusSplashScreen.unbindStartPresentationBtn()})}function s(e){$(document).attr("title",c.title),p.html(e),sbplusSplashScreen.get(r,c,u),sbplusControls.init(c.section,u),i()}function o(e){p.html(e)}function i(){var e=document.createElement("script");e.type="text/javascript",e.src=r.sbplus_root_directory+"scripts/libs/videojs/video.min.js",document.getElementsByTagName("head")[0].appendChild(e);var t=document.createElement("link");t.rel="stylesheet",t.href=r.sbplus_root_directory+"scripts/libs/videojs/video-js.min.css",document.getElementsByTagName("head")[0].appendChild(t),a()}function a(){$.fn.checkValueInCookie("sbplus-vjs-autoplay")?$.fn.setCookie("sbplus-vjs-autoplay",$.fn.getCookie("sbplus-vjs-autoplay")):$.fn.setCookie("sbplus-vjs-autoplay",1),$.fn.checkValueInCookie("sbplus-vjs-volume")?$.fn.setCookie("sbplus-vjs-volume",$.fn.getCookie("sbplus-vjs-volume")):$.fn.setCookie("sbplus-vjs-volume",.8),$.fn.checkValueInCookie("sbplus-vjs-playbackrate")?$.fn.setCookie("sbplus-vjs-playbackrate",$.fn.getCookie("sbplus-vjs-playbackrate")):$.fn.setCookie("sbplus-vjs-playbackrate",1),$.fn.checkValueInCookie("sbplus-vjs-enabledSubtitles")?$.fn.setCookie("sbplus-vjs-enabledSubtitles",$.fn.getCookie("sbplus-vjs-enabledSubtitles")):$.fn.setCookie("sbplus-vjs-enabledSubtitles",0)}function l(){var e=$(window).outerHeight()-($(".main_content_wrapper .title_bar").outerHeight()+$(".main_content .control_bar_wrapper").outerHeight()+$(".main_content .container .content").outerHeight()),t=100*(1-$(".main_content_wrapper .title_bar").outerHeight()/$(window).outerHeight());$(".main_content, .side_panel").css("height",t+"%"),$(".main_content .notes").css("height",e)}var r,u={accent:"#535cab",slideFormat:"jpg",analytics:"off",xmlVersion:"3",trackCount:0},c={data:"",trackCount:0},p;return $(document).ready(function(){p=$(".sbplus_wrapper"),$.getJSON($.fn.getConfigFileUrl(),function(t){r=t,e()}).fail(function(){sbplusError.show("Configuration file (manifest.json) is not found!","Please make sure the index.html file is compatible with Storybook Plus version 3.")})}),{render:n}}(),sbplusDownloadable=function(){function e(){var e=$.fn.getProgramDirectory();$.get(e+".mp4",function(){s=this.url}).always(function(){$.get(e+".mp3",function(){o=this.url}).always(function(){$.get(e+".pdf",function(){i=this.url}).always(function(){$.get(e+".zip",function(){a=this.url}).always(function(){n()})})})})}function t(e,t){return'<a class="dl_item '+e+'" href="'+t+'" role="button" tabindex="1" aria-label="Download '+e+' file" download><span class="icon-download"></span> '+e.capitalize()+"</a> "}function n(){var e="";"undefined"!=typeof s&&(e+=t("video",s)),"undefined"!=typeof o&&(e+=t("audio",o)),"undefined"!=typeof i&&(e+=t("transcript",i)),"undefined"!=typeof a&&(e+=t("supplement",a)),$(".download_files").hide().html(e).fadeIn(500)}var s,o,i,a;return{get:e}}(),sbplusError=function(){function e(e,o){n=e,s=o,t()}function t(){$(".sbplus_wrapper").html('<div class="error"><h1>'+n+"</h1><p>"+s+"</p></div>")}var n,s;return{show:e}}(),sbplusSplashScreen=function(){function e(e,t,n){o=e,i=t,a=n,$.get(e.sbplus_root_directory+"scripts/templates/splashscreen.tpl",function(e){$.get("assets/splash.jpg",function(){l="assets/splash.jpg"}).fail(function(){$.get(o.sbplus_splash_directory+$.fn.getProgramDirectory()+i.postfix+".jpg",function(){l=this.url}).fail(function(){$.get(o.sbplus_splash_directory+$.fn.getProgramDirectory()+".jpg",function(){l=this.url})})}),s(e)}).fail(function(){sbplusError.show("Template file not found!","splashscreen.tpl file not found in the templates directory.")})}function t(){r.on("click",function(){sbplus.render()})}function n(){r.off("click")}function s(e){$(".splashscreen").html(e),""!==l&&$(".splashscreen").css("background-image","url("+l+")"),$(".splashinfo .title").html(i.title),$(".splashinfo .subtitle").html(i.subtitle),$(".splashinfo .author").html(i.author),$(".splashinfo .length").html(i.length),$(".splashinfo .startBtn").css("background-color",a.accent),navigator.cookieEnabled&&$.fn.checkValueInCookie("sbplus-"+$.fn.getRootDirectory())&&$(".splashinfo .resumeBtn").css("background-color",a.accent).removeClass("hide"),r=$(".splashinfo .startBtn"),t(),sbplusDownloadable.get()}var o,i,a,l="",r;return{get:e,unbindStartPresentationBtn:n}}(),sbplusControls=function(){function e(e,r){s=e,o=r,a=$(s).find("page").length,i=$(s).length,$(".control_bar_wrapper .next").on("click",function(){var e=Number($(".selectee.selected").data("section")),n=$(s[e]).find("page").length,r=Number($(".selectee.selected").data("page"));l=Number($(".selectee.selected").data("order")),n-1>r?r++:(r=0,i-1>e&&e++),l++,l>a-1&&(r=0,e=0,l=0),sbplusSlide.get(s,o,e,r),t()}),$(".control_bar_wrapper .previous").on("click",function(){var e=Number($(".selectee.selected").data("section")),n=$(s[e]).find("page").length,i=Number($(".selectee.selected").data("page"));l=Number($(".selectee.selected").data("order")),i--,l--,sbplusSlide.get(s,o,e,i),t()}),n()}function t(e){e="undefined"!=typeof e?e:l,$(".control_bar_wrapper .status .current").html(e+1)}function n(){t(),$(".control_bar_wrapper .status .total").html(a)}var s,o,i=0,a=0,l=0;return{init:e,update:t}}(),sbplusTableOfContents=function(){function e(e,n){i=n,o=e,t()}function t(){var e=$(".tableOfContents");$.each(o.section,function(t){var n=$(this).find("page"),s=$.fn.isEmpty($(this).attr("title"))?"Section "+(t+1):$(this).attr("title");e.append('<div class="section"><div class="header"><div class="title">'+s+'</div><div class="expandCollapseIcon"><span class="icon-collapse"></span></div></div><div class="content"><ul class="selectable">'),$.each(n,function(e){$(".selectable:eq("+t+")").append('<li class="selectee" data-section="'+t+'" data-page="'+e+'" data-order="'+o.trackCount+'">'+("quiz"!==$(this).attr("type")?'<span class="num">'+(o.trackCount+1)+".</span> ":'<span class="icon-assessment"></span> ')+$(this).attr("title")+"</li>"),o.trackCount++}),e.append("</ul></div></div>")}),n()}function n(){var e=$(".tableOfContents .section .header"),t=$(".selectable .selectee");o.section.length>=2?e.on("click",function(){var e=$(this).parent().find(".content"),t=$(this).parent().find(".expandCollapseIcon").find("span");$(e).is(":visible")?e.slideUp(250,function(){$(t).removeClass("icon-collapse").addClass("icon-open")}):e.slideDown(250,function(){$(t).removeClass("icon-open").addClass("icon-collapse")})}):e.remove(),t.on("click",function(){if(o.section.length>=2){var e=$(this).parent().parent().prev();$(".header").removeClass("current"),$(e).addClass("current")}$(this).hasClass("selected")||(sbplusSlide.get(o.section,i,$(this).data("section"),$(this).data("page")),sbplusControls.update(Number($(this).data("order")))),t.removeClass("selected"),$(this).addClass("selected")})}function s(e,t){$(".header").removeClass("current"),$(".selectee").removeClass("selected"),$(".section .header:eq("+e+")").addClass("current"),$(".section:eq("+e+') .selectee[data-page="'+t+'"]').addClass("selected")}var o,i;return{get:e,update:s}}(),sbplusSlide=function(){function e(e,n,s,o){s="undefined"!=typeof s?Number(s):0,o="undefined"!=typeof o?Number(o):0,a=n,i=e,d=a.slideFormat,t(s,o)}function t(e,t){var s=$(i[e]).find("page")[t];r=$(s).attr("type"),p="quiz"!==r?$(s).attr("src"):"",null!==f&&(f.dispose(),f=null),n(),sbplusTableOfContents.update(e,t)}function n(){var e=$(".main_content .container .content"),t="";switch(r){case"audio":case"video":"video"===r?(l="assets/video/",u="video/mp4",c=".mp4"):(l="assets/audio/",u="audio/mp3",c=".mp3"),$.get("assets/slide/"+p+"."+d,function(){t=this.url,o()}).fail(function(){"audio"===r?e.before('<div class="slideError">Slide image not found!<br>Expected image: assets/slide/'+p+"."+d+"</div>"):o()}).always(function(){$.get(l+p+".vtt",function(){h=!0}).always(function(){e.html('<video id="ap" class="video-js vjs-default-skin" poster="'+t+'"></video>').promise().done(function(){s("ap")})})})}}function s(e){var t={techOrder:["html5"],width:640,height:360,controls:!0,autoplay:1===Number($.fn.getCookie("sbplus-vjs-autoplay")),preload:"auto",playbackRates:[.5,1,1.5,2],controlBar:{fullscreenToggle:!1},plugins:{}};switch(e){case"ap":t.plugins=null}f=videojs(e,t,function(){this.src({type:u,src:l+p+c}),h&&this.addRemoteTextTrack({src:l+p+".vtt",kind:"subtitles",label:"English",srclang:"en",default:1===Number($.fn.getCookie("sbplus-vjs-enabledSubtitles"))}),this.playbackRate($.fn.getCookie("sbplus-vjs-playbackrate")),this.volume(Number($.fn.getCookie("sbplus-vjs-volume"))),this.on("volumechange",function(){$.fn.setCookie("sbplus-vjs-volume",this.volume())}),this.on("ratechange",function(){$.fn.setCookie("sbplus-vjs-playbackrate",this.playbackRate())}),this.remoteTextTracks().addEventListener("change",function(){"English"===this.tracks_[0].label&&("showing"===this.tracks_[0].mode?$.fn.setCookie("sbplus-vjs-enabledSubtitles",1):$.fn.setCookie("sbplus-vjs-enabledSubtitles",0))})})}function o(){$(".slideError").length&&$(".slideError").remove()}var i,a,l,r,u,c,p,d,f=null,h=!1;return{get:e}}(),sbplusNotes=function(){function e(e){n=e,t()}function t(){}var n;return{get:e}}(),sbplusMenu=function(){function e(e){i=e,t()}function t(){n()}function n(){$(".menuBtn").on("click",function(){return $(this).attr("aria-expanded","true"),$("#menu_panel").removeClass("hide").attr("aria-expanded","true"),!1}),$(".backBtn").on("click",function(){return o(),!1}),$(".closeBtn").on("click",function(){return $(".menuBtn").attr("aria-expanded","false"),$("#menu_panel").addClass("hide").attr("aria-expanded","false"),o(),!1}),$("#showProfile").on("click",s),$("#showGeneralInfo").on("click",s),$("#showHelp").on("click",s),$("#showSettings").on("click",s)}function s(){var e,t,n="#"+this.id;switch(n){case"#showProfile":e="Author Profile",t=i.authorBio;break;case"#showGeneralInfo":e="General Information",t=i.generalInfo;break;case"#showHelp":e="Help",t="<p>Help information go here...</p>";break;case"#showSettings":e="Settings",t="<p>Settings go here...</p>";break;default:e="",t=""}return""!==e&&""!==t&&o(this,e,t),!1}function o(e,t,n){return"undefined"==typeof e?($(".menu_item a").attr("aria-expanded","false"),void $(".menu_item_details").attr("aria-expanded","false").animate({right:"-100%"},250,function(){$(this).addClass("hide")})):($(e).attr("aria-expanded","true"),$(".menu_item_details").attr("aria-expanded","true"),$(".menu_item_details .navbar .title").html(t),$(".menu_item_details .menu_item_content").html(n),void $(".menu_item_details").removeClass("hide").animate({right:"0px"},250))}var i;return{get:e}}();$.fn.getProgramDirectory=function(){var e=window.location.href.split("/");return($.fn.isEmpty(e[e.length-1])||new RegExp("[?]").test(e[e.length-1]))&&e.splice(e.length-1,1),void 0===e[4]?e[3]:e[4]},$.fn.getRootDirectory=function(){var e=window.location.href.split("/");return($.fn.isEmpty(e[e.length-1])||new RegExp("[?]").test(e[e.length-1])||"index.html"===e[e.length-1])&&e.splice(e.length-1,1),e[e.length-1]},$.fn.getConfigFileUrl=function(){var e=document.getElementById("sbplus_configs");return null===e?!1:e.href},$.fn.isEmpty=function(e){return!e.trim()||0===e.trim().length},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},$.fn.haveCoreFeatures=function(){return!!(Modernizr.audio&&Modernizr.video&&Modernizr.json&&Modernizr.flexbox)},$.fn.setCookie=function(e,t,n){var s=new Date;s.setTime(s.getTime()+24*n*60*60*1e3);var o="expires="+s.toUTCString();document.cookie=e+"="+t+"; "+o},$.fn.getCookie=function(e){for(var t=e+"=",n=document.cookie.split(";"),s=0;s<n.length;s++){for(var o=n[s];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""},$.fn.deleteCookie=function(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"},$.fn.checkValueInCookie=function(e){var t=$.fn.getCookie(e);return""!==t};
//# sourceMappingURL=./sbplus.js.map