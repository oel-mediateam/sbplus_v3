function MenuBar(e,t){this.$id=$("#"+e),this.$rootItems=this.$id.children("li"),this.$items=this.$id.find(".menu-item").not(".separator"),this.$parents=this.$id.find(".menu-parent"),this.$allItems=this.$parents.add(this.$items),this.$activeItem=null,this.vmenu=t,this.bChildOpen=!1,this.keys={tab:9,enter:13,esc:27,space:32,left:37,up:38,right:39,down:40},this.bindHandlers()}MenuBar.prototype.bindHandlers=function(){var e=this;this.$items.on("mouseenter",function(){return $(this).addClass("menu-hover"),!0}),this.$items.on("mouseout",function(){return $(this).removeClass("menu-hover"),!0}),this.$allItems.on("click",function(){return e.handleClick($(this))}),this.$allItems.on("keydown",function(t){return e.handleKeydown($(this),t)}),this.$allItems.on("keypress",function(t){return e.handleKeypress($(this),t)}),this.$allItems.on("focus",function(t){return e.handleFocus($(this),t)}),this.$allItems.on("blur",function(t){return e.handleBlur($(this),t)}),$(document).on("click",function(t){return e.handleDocumentClick(t)})},MenuBar.prototype.handleMouseEnter=function(e){return e.addClass("menu-hover").attr("aria-expanded","true"),"true"===e.attr("aria-haspopup")&&e.children("ul").attr({"aria-hidden":"false","aria-expanded":"true"}),!0},MenuBar.prototype.handleMouseOut=function(e){return e.removeClass("menu-hover").attr("aria-expanded","false"),!0},MenuBar.prototype.handleMouseLeave=function(e){var t=e.find(".menu-focus");return e.removeClass("menu-hover").attr("aria-expanded","false"),t.length>0&&(this.bChildOpen=!1,t.removeClass("menu-focus"),this.$activeItem=e,e.focus()),e.children("ul").attr({"aria-hidden":"true","aria-expanded":"false"}),!0},MenuBar.prototype.handleClick=function(e){var t=e.parent();if(t.is(".root-level")){var i=e.children("ul").first();"false"===i.attr("aria-hidden")?(e.attr("aria-expanded","false"),i.attr({"aria-hidden":"true","aria-expanded":"false"})):(e.attr("aria-expanded","true"),i.attr({"aria-hidden":"false","aria-expanded":"true"}))}else this.$allItems.removeClass("menu-hover menu-focus"),e.attr("aria-expanded","false"),this.$id.find("ul").not(".root-level").attr({"aria-hidden":"true","aria-expanded":"false"})},MenuBar.prototype.handleFocus=function(e){if(null===this.$activeItem)this.$activeItem=e;else if(e[0]!==this.$activeItem[0])return!0;var t=this.$activeItem.parentsUntil("div").filter("li");if(this.$allItems.removeClass("menu-focus"),this.$activeItem.addClass("menu-focus"),t.addClass("menu-focus"),this.vmenu===!0)if(this.bChildOpen===!0){var i=e.parent();i.is(".root-level")&&"true"===e.attr("aria-haspopup")&&(e.attr("aria-expanded","true"),e.children("ul").attr({"aria-hidden":"false","aria-expanded":"true"}))}else this.vmenu=!1;return!0},MenuBar.prototype.handleBlur=function(e){return e.removeClass("menu-focus"),!0},MenuBar.prototype.handleKeydown=function(e,t){if(t.altKey||t.ctrlKey)return!0;var i=e.parent();switch(t.keyCode){case this.keys.tab:e.attr("aria-expanded","false"),this.$id.find("ul").attr({"aria-hidden":"true","aria-expanded":"false"}),this.$allItems.removeClass("menu-focus"),this.$activeItem=null,this.bChildOpen=!1;break;case this.keys.esc:return e.attr("aria-expanded","false"),i.is(".root-level")?e.children("ul").first().attr({"aria-hidden":"true","aria-expanded":"false"}):(this.$activeItem=i.parent(),this.bChildOpen=!1,this.$activeItem.focus(),i.attr({"aria-hidden":"true","aria-expanded":"false"})),t.stopPropagation(),!1;case this.keys.enter:case this.keys.space:var a=e.parent();if(a.is(".root-level"))e.children("ul").first().attr({"aria-hidden":"false","aria-expanded":"true"});else{this.$allItems.removeClass("menu-hover menu-focus"),this.$id.find("ul").not(".root-level").attr({"aria-hidden":"true","aria-expanded":"false"});var s=this.$activeItem.find("a").attr("id");document.getElementById(s).click(),this.$activeItem=null}return t.stopPropagation(),!1;case this.keys.left:return this.vmenu===!0&&i.is(".root-level")?this.$activeItem=this.moveUp(e):this.$activeItem=this.moveToPrevious(e),this.$activeItem.focus(),t.stopPropagation(),!1;case this.keys.right:return this.vmenu===!0&&i.is(".root-level")?this.$activeItem=this.moveDown(e):this.$activeItem=this.moveToNext(e),this.$activeItem.focus(),t.stopPropagation(),!1;case this.keys.up:return this.vmenu===!0&&i.is(".root-level")?this.$activeItem=this.moveToPrevious(e):this.$activeItem=this.moveUp(e),this.$activeItem.focus(),t.stopPropagation(),!1;case this.keys.down:return this.vmenu===!0&&i.is(".root-level")?this.$activeItem=this.moveToNext(e):this.$activeItem=this.moveDown(e),this.$activeItem.focus(),t.stopPropagation(),!1}return!0},MenuBar.prototype.moveToNext=function(e){var t=e.parent(),i=t.children("li"),a=i.length,s=i.index(e),n=null,r=null;if(t.is(".root-level"))n=s<a-1?e.next():i.first(),"true"===e.attr("aria-haspopup")&&(r=e.children("ul").first(),"false"===r.attr("aria-hidden")&&(e.attr("aria-expanded","false"),r.attr({"aria-hidden":"true","aria-expanded":"false"}),this.bChildOpen=!0)),e.removeClass("menu-focus"),"true"===n.attr("aria-haspopup")&&this.bChildOpen===!0&&(r=n.children("ul").first(),e.attr("aria-expanded","true"),r.attr({"aria-hidden":"false","aria-expanded":"true"}));else if("true"===e.attr("aria-haspopup"))r=e.children("ul").first(),n=r.children("li").first(),e.attr("aria-expanded","true"),r.attr({"aria-hidden":"false","aria-expanded":"true"});else{if(this.vmenu===!0)return e;var o=null,l=null;o=e.parentsUntil("div").filter("ul").not(".root-level"),e.attr("aria-expanded","false"),o.attr({"aria-hidden":"true","aria-expanded":"false"}),o.find("li").removeClass("menu-focus"),o.last().parent().removeClass("menu-focus"),l=o.last().parent(),s=this.$rootItems.index(l),n=s<this.$rootItems.length-1?l.next():this.$rootItems.first(),n.addClass("menu-focus"),"true"===n.attr("aria-haspopup")&&(r=n.children("ul").first(),n=r.children("li").first(),e.attr("aria-expanded","true"),r.attr({"aria-hidden":"false","aria-expanded":"true"}),this.bChildOpen=!0)}return n},MenuBar.prototype.moveToPrevious=function(e){var t=e.parent(),i=t.children("li"),a=i.index(e),s=null,n=null;if(t.is(".root-level"))s=a>0?e.prev():i.last(),"true"===e.attr("aria-haspopup")&&(n=e.children("ul").first(),"false"===n.attr("aria-hidden")&&(e.attr("aria-expanded","false"),n.attr({"aria-hidden":"true","aria-expanded":"false"}),this.bChildOpen=!0)),e.removeClass("menu-focus"),"true"===s.attr("aria-haspopup")&&this.bChildOpen===!0&&(n=s.children("ul").first(),e.attr("aria-expanded","true"),n.attr({"aria-hidden":"false","aria-expanded":"true"}));else{var r=t.parent(),o=r.parent();this.vmenu!==!0&&o.is(".root-level")?(e.attr("aria-expanded","false"),t.attr({"aria-hidden":"true","aria-expanded":"false"}),e.removeClass("menu-focus"),r.removeClass("menu-focus"),a=this.$rootItems.index(r),s=a>0?r.prev():this.$rootItems.last(),s.addClass("menu-focus"),"true"===s.attr("aria-haspopup")&&(n=s.children("ul").first(),e.attr("aria-expanded","true"),n.attr({"aria-hidden":"false","aria-expanded":"true"}),this.bChildOpen=!0,s=n.children("li").first())):(s=t.parent(),e.attr("aria-expanded","false"),t.attr({"aria-hidden":"true","aria-expanded":"false"}),e.removeClass("menu-focus"),this.vmenu===!0&&(this.bChildOpen=!1))}return s},MenuBar.prototype.moveDown=function(e,t){var i=e.parent(),a=i.children("li").not(".separator"),s=a.length,n=a.index(e),r=null,o=null;if(i.is(".root-level"))return"true"!==e.attr("aria-haspopup")?e:(o=e.children("ul").first(),r=o.children("li").first(),$(o.parent()).attr("aria-expanded","true"),e.attr("aria-expanded","true"),o.attr({"aria-hidden":"false","aria-expanded":"true"}),r);if(t){var l=!1,u=n+1;for(u===s&&(u=0);u!==n;){var d=a.eq(u).html().charAt(0);if(d.toLowerCase()===t){l=!0;break}u+=1,u===s&&(u=0)}return l===!0?(r=a.eq(u),e.removeClass("menu-focus"),r):e}return r=n<s-1?a.eq(n+1):a.first(),e.removeClass("menu-focus"),r},MenuBar.prototype.moveUp=function(e){var t=e.parent(),i=t.children("li").not(".separator"),a=i.index(e),s=null;return t.is(".root-level")?e:(s=a>0?i.eq(a-1):i.last(),e.removeClass("menu-focus"),s)},MenuBar.prototype.handleKeypress=function(e,t){if(t.altKey||t.ctrlKey||t.shiftKey)return!0;switch(t.keyCode){case this.keys.tab:return!0;case this.keys.esc:case this.keys.up:case this.keys.down:case this.keys.left:case this.keys.right:return t.stopPropagation(),!1;default:var i=String.fromCharCode(t.which);return this.$activeItem=this.moveDown(e,i),this.$activeItem.focus(),t.stopPropagation(),!1}},MenuBar.prototype.handleDocumentClick=function(){return this.$allItems.removeClass("menu-focus"),this.$activeItem=null,!0};var SBPLUS=SBPLUS||{layout:null,menu:null,button:null,manifest:null,isReady:!1,alreadyLoaded:!1,ready:function(){if(null!==this.manifest)return"Storybook Plus is already in ready state.";var e=this;this.layout={isMobile:!1,html:"html",wrapper:".sbplus_wrapper",sbplus:"#sbplus",errorScreen:"#sbplus_error_screen",splashScreen:"#sbplus_splash_screen",widget:"#sbplus_widget",media:"#sbplus_media_wrapper",sidebar:"#sbplus_right_col",dwnldMenu:null},this.button={start:"#sbplus_start_btn",resume:"#sbplus_resume_btn",download:"#sbplus_download_btn",widget:"#sbplus_widget_btn",sidebar:"#sbplus_sidebar_btn",author:"#sbplus_author_name",menu:"#sbplus_menu_btn"},this.menu={menuPanel:"#sbplus_menu_items_wrapper",menuBar:"#sbplus_sub_bar",menuList:"#sbplus_menu_items_wrapper .list",menuItem:"#sbplus_menu_items_wrapper .menu.item",menuContent:"#menu_item_content"},$.getJSON(this.getManifestUrl(),function(t){e.isReady=!0,e.manifest=t,e.loadTemplate()}).fail(function(){var t='<div class="error">';t+="<p><strong>Storybook Plus Error:</strong> ",t+="failed to load the manifest file.<br>",t+="Expecting: <code>"+this.url+"</code></p>",t+="</div>",$(e.layout.wrapper).html(t)})},loadTemplate:function(){if(!this.isReady||this.alreadyLoaded!==!1)return"Storybook Plus template already loaded.";var e=this,t=this.manifest.sbplus_root_directory;t+="scripts/templates/sbplus.tpl",$.get(t,function(t){return e.alreadyLoaded=!0,$(e.layout.wrapper).html(t),e.resize(),e.setURLOptions(),0===e.checkForSupport()?(e.showErrorScreen(),!1):($(e.button.sidebar).on("click",e.toggleSidebar.bind(e)),$(e.button.widget).on("click",e.toggleWidget.bind(e)),$(e.button.menu).on("click",e.toggleMenu.bind(e)),$(e.button.author).on("click",e.showAthrPrfl.bind(e)),$(e.button.start).on("click",e.hideSplash.bind(e)),$(e.button.resume).on("click",e.hideSplash.bind(e)),e.layout.dwnldMenu=new MenuBar($(e.button.download)[0].id,!1),void $(window).on("resize",e.resize.bind(e)))}).fail(function(){var t='<div class="error">';t+="<p><strong>Storybook Plus Error:</strong> ",t+="failed to load template.<br>",t+="Expecting: <code>"+this.url+"</code></p>",t+="</div>",$(e.layout.wrapper).html(t)})},hideSplash:function(){$(this.layout.splashScreen).addClass("fadeOut").one("webkitAnimationEnd mozAnimationEnd animationend",function(){$(this).removeClass("fadeOut").hide(),$(this).off()})},toggleSidebar:function(){$(this.layout.sidebar).is(":visible")?this.hideSidebar():this.showSidebar()},hideSidebar:function(){var e=$(this.layout.widget),t=$(this.layout.media);$(this.layout.sidebar).hide(),$(this.button.sidebar).removeClass("sb_active"),e.is(":visible")&&e.outerHeight()<=190&&t.removeClass("aspect_ratio").addClass("non_aspect_ratio")},showSidebar:function(){var e=$(this.layout.widget),t=$(this.layout.media);$(this.layout.sidebar).show(),$(this.button.sidebar).addClass("sb_active"),e.is(":visible")&&e.outerHeight()<=190&&t.removeClass("non_aspect_ratio").addClass("aspect_ratio")},toggleWidget:function(){$(this.layout.widget).is(":visible")?this.hideWidget():this.showWidget()},hideWidget:function(){var e=$(this.layout.media);$(this.layout.widget).hide(),$(this.button.widget).removeClass("sb_active"),this.layout.isMobile?(e.addClass("aspect_ratio"),this.resize()):e.removeClass("aspect_ratio").addClass("non_aspect_ratio").css("height","100%")},showWidget:function(){$(this.layout.widget).show(),$(this.button.widget).addClass("sb_active"),$(this.layout.media).removeClass("non_aspect_ratio").addClass("aspect_ratio").css("height",""),this.resize()},toggleMenu:function(){$(this.menu.menuPanel).is(":visible")?this.hideMenu():this.showMenu()},showMenu:function(){$(this.layout.sidebar).is(":visible")||this.showSidebar();var e=$(this.menu.menuPanel);$(this.button.menu).html('<span class="icon-close"></span>').css({color:"#f00","padding-top":"4px"}),$(this.menu.menuBar).find(".title").html("Menu"),e.show().addClass("slideInRight").one("webkitAnimationEnd mozAnimationEnd animationend",function(){$(this).removeClass("slideInRight")}),$(this.menu.menuItem).on("click",this.openMenuItem.bind(this))},hideMenu:function(){var e=$(this.menu.menuPanel),t=$(this.menu.menuBar);$(this.button.menu).html("Menu").css({color:"","padding-top":""}),t.find(".title").html("Table of Contents"),e.addClass("slideOutRight").one("webkitAnimationEnd mozAnimationEnd animationend",function(){e.hide().removeClass("slideOutRight"),$(this).off()}),this.resetMenu()},openMenuItem:function(e){var t="";t="string"==typeof e?e:"#"+e.currentTarget.id;var i=$(this.menu.menuBar),a=$(this.menu.menuList),s=$(this.menu.menuContent),n=$(t),r=i.find(".backBtn");i.removeClass("full"),i.find(".title").html(n.html()),a.addClass("fadeOutLeft").one("webkitAnimationEnd mozAnimationEnd animationend",function(){$(this).hide().removeClass("fadeOutLeft"),s.show().html("<p>External template data here...</p>"),$(this).off()}),r.html('<span class="icon-left"></span>').prop("disabled",!1).on("click",function(){i.addClass("full").find(".title").html("Menu"),a.show().addClass("fadeInLeft").one("webkitAnimationEnd mozAnimationEnd animationend",function(){$(this).removeClass("fadeInLeft"),$(this).off()}),s.hide().empty(),$(this).empty().prop("disabled",!0),$(this).off("click")})},resetMenu:function(){var e=$(this.menu.menuBar);e.addClass("full").find(".backBtn").html("").prop("disabled",!0),e.find(".title").html("Table of Contents"),$(this.menu.menuList).show(),$(this.menu.menuContent).empty().hide(),$(this.menu.menuItem).off("click")},showAthrPrfl:function(){$(this.menu.menuPanel).is(":visible")||this.showMenu(),this.openMenuItem("#sbplus_author_profile")},showErrorScreen:function(){$(this.layout.sbplus).hide(),$(this.layout.errorScreen).show().addClass("shake").css("display","flex")},checkForSupport:function(){return Modernizr.video&&Modernizr.eventlistener&&Modernizr.json&&Modernizr.flexbox&&Modernizr.flexwrap&&Modernizr.csscalc?1:0},calcLayout:function(){var e=$(this.layout.media),t=$(this.layout.widget),i=$(this.layout.sidebar);window.innerWidth>=1826?e.removeClass("aspect_ratio").addClass("non_aspect_ratio"):e.removeClass("non_aspect_ratio").addClass("aspect_ratio"),t.is(":visible")||e.css("height","100%"),window.innerWidth<=740||window.screen.width<=414?this.layout.isMobile=!0:this.layout.isMobile=!1,this.layout.isMobile===!1&&t.outerHeight()<=190&&e.removeClass("aspect_ratio").addClass("non_aspect_ratio"),this.layout.isMobile===!0?i.css("height","calc( 100% - "+e.height()+"px)"):i.css("height",""),this.calcWidgetHeight()},calcWidgetHeight:function(){var e=$(this.layout.sidebar),t=$(this.layout.widget);this.layout.isMobile===!0?t.css({height:e.outerHeight(),bottom:e.outerHeight()*-1}):t.css({height:"",bottom:""})},resize:function(){this.calcLayout(),this.layout.isMobile&&this.showSidebar()},setURLOptions:function(){var e=$(this.layout.html),t=$(this.layout.wrapper);"1"===this.getUrlParam("fullview")?(e.addClass("sbplus_pop_full"),t.removeClass("sbplus_boxed").addClass("sbplus_full")):(e.removeClass(".sbplus_pop_full"),t.addClass("sbplus_boxed").removeClass("sbplus_full"))},getUrlParam:function(e){var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(window.location.href);return null===t?null:t[1]||0},getManifestUrl:function(){var e=$("#sbplus_configs");return e.length?e[0].href:""}};$(function(){SBPLUS.ready()});